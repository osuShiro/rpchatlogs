<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Editing {{ session.title }} for {{ game.name }}</title>
    <link rel="stylesheet" type="text/css" href="/static/chatlog.css">
</head>
<body>
    <p><a href="/game-admin/{{ game.name }}/">Return to game page</a></p>
    <p><a href="/game-admin/{{ game.name }}/session/{{ session.title }}/append/">Add new messages to this session</a></p>
    {% if messages %}
    <table class="chatlog">
            {% csrf_token %}
            {% for message in messages %}
            <tr style="padding: 0px; margin: 0px">
                <form action="" method="post">
                    {% csrf_token %}
                    <td class="edit-buttons">
                        <input type="submit" name="delete" value="delete" style="margin: 0px">
                        <input type="hidden" name="message_id" value="{{ message.id }}">
                    </td>
                    <td class="edit-body">
                        {% if message.message_type == "e" %}
                            <div class="emote">
                                {{ message.text }}
                            </div>
                        {% elif message.message_type == "d" %}
                            <div class="desc">
                                {{ message.text }}
                            </div>
                        {% else %}
                        <div class="message">
                            {{ message.owner }}
                            {% if message.message_type == "r" %}
                                <div class="roll">
                                    {{ message.formula }}: <span class="result">{{ message.result }}</span> ({{ message.rolls }})
                                </div>
                            {% elif message.message_type == "k" %}
                                <div class="skill">
                                    {{ message.text }}: <span class="result">{{ message.result }}</span>
                                    <span class="details">({{ message.details }})</span>
                                </div>
                            {% elif message.message_type == "t" %}
                                <div class="attack">
                                    <span class="attack-title">
                                        {{ message.text }}
                                    </span><br />
                                    {% for attack in message.attacks %}
                                    <li>{{ attack.name }}: <span class="result">{{ attack.result }}</span>
                                        <span class="details">({{ attack.roll_detail }})</span>
                                    </li>
                                    {% endfor %}
                                </div>
                            {% elif message.message_type == "p" %}
                                <div class="skill">
                                    {{ message.text }}
                                </div>
                            {% elif message.message_type == "b" %}
                                <div class="skill">
                                    {{ message.text }}
                                </div>
                            {% elif message.message_type == "g" %}
                            {{ message.text }}
                            {% endif %}
                        </div>
                        {% endif %}
                    </td>
                </form>
            </tr>
            {% endfor %}
    </table>
    {% else %}
    <p>No chatlog for this session.</p>
    {% endif %}
</body>
</html>